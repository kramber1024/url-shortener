(()=>{"use strict";function t(t,e){let n=document.getElementById(`${t}-error`);if(!n)if(n=function(t,e){const n=document.createElement("label");return n.id=`${t}-error`,n.htmlFor=t,n.className="error",n.textContent=e,n}(t,e),"terms"===t){document.querySelector(".terms-container").insertAdjacentElement("afterend",n)}else{document.getElementById(t).after(n)}n.textContent=e}function e(t){const e=document.getElementById(`${t}-error`);e&&e.remove()}var n=function(t,e,n,a){return new(n||(n=Promise))((function(r,i){function o(t){try{m(a.next(t))}catch(t){i(t)}}function s(t){try{m(a.throw(t))}catch(t){i(t)}}function m(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}m((a=a.apply(t,e||[])).next())}))};const a=document.querySelector("form"),r=document.getElementById("first_name"),i=document.getElementById("last_name"),o=document.getElementById("email"),s=document.getElementById("password"),m=document.getElementById("terms");a.addEventListener("submit",(d=>n(void 0,void 0,void 0,(function*(){d.preventDefault();const n=new FormData(a);let l=!0;const c=n.get("first_name").trim(),u=n.get("last_name").trim(),g=n.get("email").trim(),f=n.get("password"),h=n.get("terms")?"on":"off";if(c?c.length<3?(l=!1,t("first_name",r.getAttribute("data-msg-minlength"))):c.length>32?(l=!1,t("first_name",r.getAttribute("data-msg-maxlength"))):e("first_name"):(l=!1,t("first_name",r.getAttribute("data-msg-required"))),u||n.delete("last_name"),u.length<3&&u.length>0?(l=!1,t("last_name",i.getAttribute("data-msg-minlength"))):u.length>32?(l=!1,t("last_name",i.getAttribute("data-msg-maxlength"))):e("last_name"),g?!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)||g.length>64||g.length<5?(l=!1,t("email",o.getAttribute("data-msg-invalid"))):e("email"):(l=!1,t("email",o.getAttribute("data-msg-required"))),f?f.length<8?(l=!1,t("password",s.getAttribute("data-msg-minlength"))):f.length>256?(l=!1,t("password",s.getAttribute("data-msg-maxlength"))):e("password"):(l=!1,t("password",s.getAttribute("data-msg-required"))),"on"!==h?(l=!1,t("terms",m.getAttribute("data-msg-required"))):e("terms"),!l)return;!function(){const t=document.createElement("div");t.className="loader";const e=document.querySelector("button");e.disabled=!0,e.textContent="",e.appendChild(t)}();let y=JSON.stringify(Object.fromEntries(n.entries())),b=yield fetch("/api/v1/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:y});const p=(yield b.json()).errors;switch(b.status){case 422:p.forEach((e=>{"email"===e.type&&t("email",o.getAttribute("data-msg-invalid"))}));break;case 409:t("email",o.getAttribute("data-msg-conflict"));break;case 201:y=JSON.stringify({email:g,password:f}),b=yield fetch("/api/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:y}),200===b.status||(window.location.href="/login")}!function(){const t=document.querySelector("button");t.disabled=!1,t.textContent="Create Account"}()}))))})();